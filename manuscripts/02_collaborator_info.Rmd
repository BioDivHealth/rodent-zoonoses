---
title: "SpREAD: Spatio-temporal Rodent Community Ecology And Disease Database."
author: "Harry Gordon, Ana Martinez-Checa, David Redding, Greg Milne"
date: "09/09/2024"
output: pdf_document
geometry: margin=2cm
fontsize: 18pt
bibliography: 01_references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    fig.width   = 10,
    fig.height  = 5,
    fig.align   = 'center',
    echo        = TRUE,
    message     = FALSE,
    warning     = FALSE,
    error       = FALSE,
    strip.white = TRUE,
    warning     = FALSE)
```

## Introduction

Rodents are reservoirs of zoonotic diseases, posing a significant threat to human health. Understanding rodent ecology and population dynamics is therefore important for mitigating human zoonotic hazards. Trapping studies have improved our understanding of zoonotic epidemiology, however, capturing known reservoirs to the exclusion of other rodent species limits inference on broader eco-epidemiological questions. Detailed information on rodent communities could be used to understand how global changes in habitat suitability and climate influence the dynamic ecosystems from which zoonotic diseases emerge and are maintained. Currently, there is no standard method for reporting rodent trapping data. This project aims to establish a high-resolution rodent community seroprevalence database by collating published data on rodent abundance and pathogen prevalence, and provide a standard for its reporting going forward. These data will facilitate robust inference on the eco-epidemiological predictors of rodent-borne disease, helping to shape our understanding of zoonotic disease risk in a changing world.

Infectious Disease Systems Ecology group, British Natural History Museum.

David Simons' paper: @simons_rodent_2023.
```{r plot_world_map, echo=FALSE, fig.cap="The geographic locations of trapped rodents included in our study. The colour of points denotes the year sampled."}
# Load necessary libraries
library(ggplot2)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)

# Load data frame
host_path <- readRDS("../data/host_path_wide.rds")
attach(host_path)

# Get the world map data
world <- ne_countries(scale = "large", returnclass = "sf")
coords_sf <- st_as_sf(host_path, coords = c("decimalLongitude", "decimalLatitude"), crs = 4326, agr = "constant")
host_path$year <- as.numeric(format(host_path$start_date, "%Y"))

# Plot the points onto the world map 
ggplot(data = world) +
  geom_sf(colour="darkgray") +
  geom_sf(data = coords_sf, aes(geometry = geometry, colour=host_path$year), size = 2, shape=18) +
  coord_sf(expand = FALSE) +                    # Keep the aspect ratio
  theme_void() +
  theme(panel.background = element_rect(), 
        axis.text = element_blank(),            # Remove axis text (tick labels)
        axis.ticks = element_blank(),
        plot.margin = margin(0, 0, 0, 0, "cm")) +
  scale_color_gradient(low = "#FF9D00", high = "#FF0000", name = "Year")
  
```

```{r plot_n_infections, echo=FALSE, message=FALSE, error=FALSE, warning=FALSE, fig.cap="The number of infections for each virus tested", fig.align='default'}
# Load necessary libraries
library(ggplot2)
library(dplyr)

# group by virus and sum infections
infection_plot <- host_path %>% group_by(pathogen_abbrev) %>% summarise(n_infections=sum(positive))
infection_plot <- infection_plot[-1, ] %>% arrange(desc(n_infections))


# Plot the points onto the world map 
ggplot(infection_plot, aes(x = reorder(pathogen_abbrev, -n_infections), y = n_infections)) +
  geom_bar(stat = "identity", fill = "steelblue") +  # Use stat = "identity" for pre-calculated y values
  annotate("point", x = 10.5, y = 70, shape = 21, size = 50, fill = "steelblue", color = "steelblue") +
  annotate("text", x = 10.5, y = 70, label = "480 total\n infections", size = 5) +
  labs(x = "Pathogen",
       y = "Number of Infections") +
  theme(plot.margin = margin(0, 0, 0, 0, "cm")) +
  theme_minimal()
  
```

### Data currently in database

We collected data from the following papers for use in this analysis: @burns_novel_2018, @cabrera_deciphering_2023, @dietrich_small-scale_1997, @fernandes_co-circulation_2015, @fulhorst_bear_2002, @jameson_continued_2013, @kosasih_evidence_2011, @ledina_dinara-new_2002, @leduc_epidemiological_1986, @mauldin_assessment_2013, @milazzo_ecology_2013, @nemirov_isolation_1999, @zhang_glc_fcs30d_2024, @seijo_study_2003, @sheikh_ali_first_2014, @suarez_prevalence_2003, @williams_outbreak_1997, @williamson_continuing_2021.

## References
